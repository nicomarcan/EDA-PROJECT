package TPE;



import java.io.IOException;
import java.util.List;
import java.util.regex.Pattern;

public class Parser{
	public boolean parse(String command,AirportManager airportM ) throws ClassNotFoundException, IOException{ 
		AirportCreator airportC = new AirportCreator();
		FlightCreator flightC = new FlightCreator();
		String addAirExp = "insert airport [a-z A-Z]{1,3} -?[0-9]+\\.[0-9]+ -?[0-9]+\\.[0-9]+";
		String delAirExp = "delete airport [a-z A-Z]{1,3}";
		String addAllAirExp = "insert all airport [a-z A-Z 0-9]+\\.txt";
		String delAllAirExp = "delete all airport";
		String addFlExp = "insert flight [a-z A-Z]{1,3} [0-9]{1,7} (Lu|Ma|Mi|Ju|Vi|Sa|Do)(-(Lu|Ma|Mi|Ju|Vi|Sa|Do))* [a-z A-Z]{1,3} [a-z A-Z]{1,3} ([0-1][0-9]|2[0-3]):[0-5][0-9] ([1-9][0-9]h])?[0-5][0-9]m$";
		String delFlExp = "delete flight [a-z A-Z]{1,3} [1-9][0-9]*";
		String addAllFlExp = "insert all flight [a-z A-Z 0-9]+\\.txt";
		String delAllFlExp = "delete all flight";
		String findRouteExp = "findRoute src=[a-z A-Z]{3} dst=[a-z A-Z]{3} priority=(((pr)|(tt))|(ft)) (weekdays=((((((Lu)(-Ma)?(-Mi)?(-Ju)?(-Vi)?(-Sa)?(-Do)?)|((Ma)(-Mi)?(-Ju)?(-Vi)?(-Sa)?(-Do)?))|((Mi)(-Ju)?(-Vi)?(-Sa)?(-Do)?))|((Ju)(-Vi)?(-Sa)?(-Do)?|((Vi)(-Sa)?(-Do)?))|((Sa)(-Do)?))|(Do)))?";
		String outputFormatExp = "outputFormat ((text)|(KML))";
		String outputExp = "output ((stdout)|(file [a-z A-Z 0-9]+\\.txt))";
		String quitExp = "quit";
		FileManager f = new FileManager();
		
		if(Pattern.matches(addAirExp,command)){
			airportC.addAirport(command,airportM);
			return false;
		}
		else if(Pattern.matches(addAllAirExp,command)){
			String[] res = command.split(" ");
			List<String> data = f.readAirports(res[3]);
			airportC.addAirports(data,airportM);
			return false;
		}
		else if(Pattern.matches(delAirExp,command)){
			airportC.deleteAirport(command, airportM);
			return false;
		}
		else if(Pattern.matches(delAllAirExp, command)){
			airportC.deleteAirports(airportM);
			return false;
		}
		else if(Pattern.matches(addFlExp, command)){
			flightC.addFlight(command,airportM);
			return false;
		}
		else if(Pattern.matches(delFlExp, command)){
			flightC.deleteFlight(command, airportM);
			return false;
		}
		else if(Pattern.matches(addAllFlExp, command)){
			String[] res = command.split(" ");
			List<String> data = f.readFlights(res[3]);
			flightC.addFlights(data,airportM);
			return false;
		}
		else if(Pattern.matches(delAllFlExp, command)){
			//airportM.deleteAllFlights();
			return false;
		}
		else if(Pattern.matches(findRouteExp, command)){
			// TODO
			return false;
		}
		else if(Pattern.matches(outputFormatExp, command)){
			// TODO
			return false;
		}
		else if(Pattern.matches(outputExp, command)){
			// TODO
			return false;
		}
		else if(Pattern.matches(quitExp, command)){
			return true;
		}
		else
			System.out.println("Ingreso un comando no vï¿½lido");
		return false;
	}

	public void parseArguments(String[] args) {
		// TODO Auto-generated method stub
		
	}


	
	
}
